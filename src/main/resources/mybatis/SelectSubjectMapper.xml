<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.slxy.www.mapper.SelectSubjectMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.slxy.www.model.SelectSubject">
        <id column="id" property="id" />
        <result column="sub_name" property="subName" />
        <result column="tea_id" property="teaId" />
        <result column="sub_type" property="subType" />
        <result column="sub_content" property="subContent" />
        <result column="adm_audit_state" property="admAuditState" />
        <result column="adm_audit_content" property="admAuditContent" />
        <result column="adm_audit_id" property="admAuditId" />
        <result column="tutor_score" property="tutorScore" />
        <result column="judge_score" property="judgeScore" />
        <result column="defence_score" property="defenceScore" />
        <result column="final_total_score" property="finalTotalScore" />
        <result column="sub_year" property="subYear" />
        <result column="gmt_create" property="gmtCreate" />
        <result column="gmt_modify" property="gmtModify" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, sub_name, tea_id, sub_type, sub_content, adm_audit_state, adm_audit_content, adm_audit_id, tutor_score,
        judge_score, defence_score, final_total_score, sub_year, gmt_create, gmt_modify
    </sql>

    <select id="getSubByPage" resultMap="BaseResultMap">
        SELECT <include refid="Base_Column_List"/> FROM select_subject a WHERE 1=1
        <if test="@Ognl@isNotEmpty(search)">
            and (
            a.sub_name like '%${search}%' or
            a.sub_year like '%${search}%'
            )
        </if>
        <if test="@Ognl@isNotEmpty(admAuditState)">
            and a.adm_audit_state = #{admAuditState}
        </if>
        <if test="@Ognl@isNotEmpty(subType)">
            and a.sub_type = #{subType}
        </if>
        <if test="@Ognl@isNotEmpty(teaId)">
            and a.tea_id = #{teaId}
        </if>
        <if test="@Ognl@isEmpty(admAuditState)">
            and a.adm_audit_state in  (1,2)
        </if>
        ORDER BY a.adm_audit_state DESC ,a.gmt_create DESC
    </select>

</mapper>
